@RestController
@RequestMapping("/nevada")
public class NevadaPythonController {

    private final NevadaPythonService service;

    public NevadaPythonController(NevadaPythonService service) { this.service = service; }

    @PostMapping("/run-python")
    public ResponseEntity<?> runPython() {
        try {
            return ResponseEntity.ok(service.runOnce());
        } catch (Exception e) {
            return ResponseEntity.internalServerError().body(e.getMessage());
        }
    }

    // temporary test to verify mapping
    @GetMapping("/ping")
    public String ping() { return "nevada ok"; }
}

#################

<button id="nvBtn" class="btn">Open</button>
<pre id="nvOut"></pre>
<script>
document.getElementById('nvBtn').onclick = async () => {
  const res = await fetch('/nevada/run-python', { method: 'POST' });
  const text = await res.text();
  try { document.getElementById('nvOut').textContent = JSON.stringify(JSON.parse(text), null, 2); }
  catch { document.getElementById('nvOut').textContent = text; }
};
</script>

################

@Configuration
@EnableWebSecurity
public class SecurityConfig {

  @Bean
  SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http
      .csrf(csrf -> csrf.ignoringRequestMatchers("/nevada/run-python"))  // disable CSRF for this endpoint
      .authorizeHttpRequests(auth -> auth
        .requestMatchers("/nevada/run-python","/nevada/ping").permitAll()
        .anyRequest().authenticated()
      );
    return http.build();
  }
}


