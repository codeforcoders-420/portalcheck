Test-Path "C:\Users\cs920074\Desktop\Backup\Python\venv\Scripts\python.exe"

"C:\Users\cs920074\Desktop\Backup\Python\venv\Scripts\python.exe" --version

@Value("${nevada.py.path}") String pythonExe;
@PostConstruct
void logPaths() { System.out.println("PYTHON EXE = " + pythonExe); }



cd C:\Users\cs920074\Desktop\Backup\Python
rmdir -Recurse -Force .\venv  # if you want to recreate
python -m venv venv
.\venv\Scripts\Activate.ps1
pip install requests beautifulsoup4 pandas openpyxl



@GetMapping("/nevada/diag")
public Map<String,Object> diag(
    @Value("${nevada.py.path}") String py,
    @Value("${nevada.script}") String script) {
  Map<String,Object> m = new LinkedHashMap<>();
  m.put("pythonPath", py);
  m.put("pythonExists", new java.io.File(py).exists());
  m.put("scriptPath", script);
  m.put("scriptExists", new java.io.File(script).exists());
  return m;
}



nevada.py.path=C:/Windows/py.exe


public JsonNode runOnce() throws Exception {
  // Sanity checks
  File py = new File(pythonExe);
  File sc = new File(scriptPath);
  if (!py.exists()) throw new RuntimeException("python.exe not found at: " + pythonExe);
  if (!sc.exists()) throw new RuntimeException("script not found at: " + scriptPath);

  List<String> cmd = List.of(
      pythonExe,
      scriptPath,
      "--base-url", baseUrl,
      "--root-dir", rootDir,
      "--header-row-index", Integer.toString(headerRowIndex)
  );
  System.out.println("Executing: " + String.join(" | ", cmd));
  return runner.runAndParseJson(new ArrayList<>(cmd), Duration.ofSeconds(timeoutSeconds));
}
